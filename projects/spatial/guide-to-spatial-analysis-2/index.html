<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Guide to spatial analysis - spatial statistics | Atma's blog</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#d4567b">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://atmamani.github.io/projects/spatial/guide-to-spatial-analysis-2/">
<link rel="icon" href="../../../scatter-16.png" sizes="16x16">
<link rel="icon" href="../../../scatter-32.png" sizes="32x32">
<link rel="icon" href="../../../scatter-64.png" sizes="64x64">
<link rel="icon" href="../../../scatter-128.png" sizes="128x128">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-113202945-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-113202945-1');
</script><meta name="author" content="Atma Mani">
<meta property="og:site_name" content="Atma's blog">
<meta property="og:title" content="Guide to spatial analysis - spatial statistics">
<meta property="og:url" content="https://atmamani.github.io/projects/spatial/guide-to-spatial-analysis-2/">
<meta property="og:description" content='1. Why study spatial statistics?
Studying spatial statistics (or statistical geography) helps answer questions such as: "How sure am I that the pattern I am seeing is not simply due to random occurren'>
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-03-06T20:49:38-08:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://atmamani.github.io/">

                <span id="blog-title">Atma's blog</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Projects <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../../math/">Learn math with Python</a>
                    </li>
<li>
<a href="../../stats/">Learn stats with Python</a>
                    </li>
<li>
<a href="../../ml/">Machine Learning projects</a>
                    </li>
<li>
<a href="../../dl/">Deep Learning projects</a>
                    </li>
<li>
<a href="../">Spatial analysis</a>
                    </li>
<li>
<a href="../../thermal/">Thermal remote sensing</a>
                    </li>
<li>
<a href="../../mwrs/">Microwave remote sensing</a>
                    </li>
<li>
<a href="../../fun/">Fun projects</a>
            </li>
</ul>
</li>
<li>
<a href="../../../blog/">Blog</a>
                </li>
<li>
<a href="../../../talks/">Talks</a>
                </li>
<li>
<a href="../../../books/">Books</a>
            </li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Cheatsheets <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../../../cheatsheets/learning-resources/">General learning resources</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../../cheatsheets/python/python_datatypes/">Python datatypes</a>
                    </li>
<li>
<a href="../../../cheatsheets/python/python_conditional_execution/">Python conditional execution</a>
                    </li>
<li>
<a href="../../../cheatsheets/python/python_functions/">Python functions</a>
                    </li>
<li>
<a href="../../../cheatsheets/python/python_iterations/">Python iterations</a>
                    </li>
<li>
<a href="../../../cheatsheets/python/python_exception_handling/">Python exception handling</a>
                    </li>
<li>
<a href="../../../cheatsheets/python/python_classes/">Python classes</a>
                    </li>
<li>
<a href="../../../images/regex-mindmap.jpg">Python regex</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../../cheatsheets/conda_cheat_sheet/">Conda basics</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../../cheatsheets/numpy/numpy_cheat_sheet_1/">NumPy basics</a>
                    </li>
<li>
<a href="../../../cheatsheets/numpy/numpy_cheat_sheet_2/">NumPy array slicing, dicing, searching</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../../cheatsheets/pandas/pandas_cheat_sheet_1/">Pandas basics</a>
                    </li>
<li>
<a href="../../../cheatsheets/pandas/pandas_cheat_sheet_2/">Pandas multilevel index, <br>    missing data, aggregation, merging</a>
                    </li>
<li>
<a href="../../../cheatsheets/pandas/pandas_cheat_sheet_3/">Productivity with Pandas</a>
                    </li>
<li>
<a href="../../../cheatsheets/pandas/pandas_data_viz_1/">Pandas data visualization</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../../cheatsheets/matplotlib/matplotlib_1/">Matplotlib basics</a>
                    </li>
<li>
<a href="../../../cheatsheets/matplotlib/matplotlib_2/">Matplotlib log scales, ticks, scientific</a>
                    </li>
<li>
<a href="../../../cheatsheets/matplotlib/matplotlib_geo/">Geographical plotting with Basemap - matplotlib toolkit</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../../cheatsheets/seaborn/seaborn_cheat_sheet_1/">Seaborn dist, joint, pair, rug plots</a>
                    </li>
<li>
<a href="../../../cheatsheets/seaborn/seaborn_cheat_sheet_2/">Seaborn categorical - bar, count, <br>violin, strip, swarm plots</a>
                    </li>
<li>
<a href="../../../cheatsheets/seaborn/seaborn_cheat_sheet_3/">Seaborn matrix, regression - heatmap, <br> cluster, regression</a>
                    </li>
<li>
<a href="../../../cheatsheets/seaborn/seaborn_cheat_sheet_4/">Seaborn grids &amp; custom - pair, facet grids <br> customization</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../../cheatsheets/plotly/plotly_cufflinks_cheat_sheet_1/">Plotly introduction</a>
                    </li>
<li>
<a href="../../../cheatsheets/plotly/plotly_cufflinks_cheat_sheet_2/">Plotly - interactive plotting</a>
                    </li>
<li>
<a href="../../../cheatsheets/plotly/plotly_geographical_plotting_1/">Plotly - geographic plotting</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../../cheatsheets/r_cheat_sheet_1/">R basics</a>
                    </li>
<li>
<a href="../../../cheatsheets/octave-1/">Octave / MATLAB - basics</a>
                    </li>
<li>
<a href="../../../cheatsheets/octave-2/">Octave - handling data</a>
                    </li>
<li>
<a href="../../../cheatsheets/js_essentials/">Javascript essentials</a>
                    </li>
<li>
<a href="../../../cheatsheets/latex-1/">Latex introduction</a>
                    </li>
<li>
<a href="../../../cheatsheets/docker-1/">Docker introduction</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../../cheatsheets/open-geo/geopandas-1/">GeoPandas - IO, projections, plotting</a>
                    </li>
<li>
<a href="../../../cheatsheets/open-geo/geopandas-2/">GeoPandas - GP, IO, interactive plotting, geocoding</a>
                    </li>
<li>
<a href="../../../cheatsheets/open-geo/geopandas-3/">GeoPandas - spatial overlays, topology</a>
                    </li>
<li>
<a href="../../../cheatsheets/open-geo/geopandas-4/">GeoPandas - PySal, OSM data IO</a>
                    </li>
<li>
<a href="../../../cheatsheets/open-geo/open-geo-raster-1/">Rasterio - IO, plotting, histograms</a>
                    </li>
<li>
<a href="../../../cheatsheets/open-geo/open-geo-raster-2/">Rasterio - hyperspectral, SAM</a>
                    </li>
<li>
<a href="../../../cheatsheets/open-geo/reading-multidim-data-using-opengeotools/">Reading multi-dimensional data using open geo tools</a>
                    </li>
<li>
<a href="../../../cheatsheets/open-geo/postgis-1/">PostGIS - introduction</a>
                    </li>
<li>
<a href="../../../cheatsheets/open-geo/postgis-2/">PostGIS - SQLAlchemy, GeoAlchemy, GeoPandas</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../../cheatsheets/web-development/">Web Development</a>
                    </li>
<li>
<a href="../../../cheatsheets/html/">HTML basics</a>
            </li>
</ul>
</li>
<li>
<a href="../../../apps/">Apps</a>
                </li>
<li>
<a href="../../../rss.xml">RSS feed</a>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="https://atmamani.github.io/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Guide to spatial analysis - spatial statistics</a></h1>

        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <h3 id="1-why-study-spatial-statistics">1. Why study spatial statistics?<a href="#1-why-study-spatial-statistics" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>Studying spatial statistics (or statistical geography) helps answer questions such as: "How sure am I that the pattern I am seeing is not simply due to random occurrence? To what extent does the value of a feature depend on its neighbors?". In addition, spatial stats can help answer questions such as</p>
<ol>
<li>How are the features distributed? (Spatial distribution)</li>
<li>What is the pattern created by these features - are the locations spatially clustered?</li>
<li>If clustered, where are the clusters?</li>
<li>What are the relationships between sets of features or values? Once you establish the strength of relationship between two layers, then you can use one to predict the other.</li>
</ol>
<h4 id="11-geographic-analysis-with-statistics">1.1 Geographic analysis with statistics<a href="#11-geographic-analysis-with-statistics" class="headerlink" title="Permalink to this heading">¶</a></h4>
<p><strong>Framing the question</strong>: In <strong>descriptive statistics</strong>, the question usually takes the form: Where is the center of crimes? What is the overall direction of storm tracks?.</p>
<p>In <strong>inferential statistics</strong>, the analysis is stated as a <strong>hypothesis</strong> and that takes the form: Burglaries are more clustered than auto thefts. To ensure impartiality, statisticians often frame the inverse of what they intend to prove as the hypothesis. Thus the same analysis would be framed as <em>Burglaries are not more clustered than auto thefts</em> (called <code>null hypothesis</code>) and they determine whether or not to reject this null hypothesis.</p>
<h4 id="12-understanding-geographic-data">1.2 Understanding geographic data<a href="#12-understanding-geographic-data" class="headerlink" title="Permalink to this heading">¶</a></h4>
<p><strong>Spatial data types</strong>: Geographic features are spread in space. Their location can be analyzed based on their location or using location influenced by an attribute value. Thus, geographic features are either discrete or spatially continuous. <strong>Discrete features</strong> can be locations of stores, weather stations etc. and are represented as <code>Points</code>. <code>Lines</code> can be <strong>disjunct</strong> (animal migration routes) or connected, as in a network (streets). Spatially continuous features such as temperature, precipitation are measured anywhere and everywhere. Such <code>continuous field</code> data are represented as a <code>Polygon</code> or as a surface.</p>
<p>Now let's talk about <strong>types of attribute values</strong>: Attribute values can be</p>
<ul>
<li>
<code>nominal</code> (categorical) - ex: land cover types, </li>
<li>
<code>ordinal</code> (ordered) - ex: soil suitability, landslide risk zone. In ordinal scale, you only know under which class a feature falls, but don't know by how much is it better or worse than features in other classes.</li>
<li>
<code>interval</code> (quantities) - ex: house prices, population. Here, each class gets an upper and lower limit allowing you to understand how wide a class range is and compare different classes.</li>
<li>
<code>ratio</code> types (proportions) - ex: population density, infection rate. </li>
</ul>
<h3 id="2-data-distributions">2. Data distributions<a href="#2-data-distributions" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>Below are some of the common distributions seen in geography:</p>
<h5 id="21-normal-distribution">2.1 Normal distribution<a href="#21-normal-distribution" class="headerlink" title="Permalink to this heading">¶</a></h5>
<p>This kind of distribution occurs for phenomena where values are similar, but some are higher and some are lower. The frequency curve of normal distribution takes shape of the classic symmetrical bell curve. Given enough readings over time, most values will cluster toward the mean.</p>
<h5 id="22-poisson-distribution">2.2 Poisson distribution<a href="#22-poisson-distribution" class="headerlink" title="Permalink to this heading">¶</a></h5>
<p>This distribution occurs when extreme events like large magnitude earthquakes occur in time and space. When events are random, there will be a few periods when many events occur, followed by several periods where no or very few events occur. For this distribution, mean number of events is often $\mu &lt; 1$ and probability of no events occurring is higher.</p>
<p><img src="../../../images/spatial-poisson.png" width="400"></p>
<h3 id="3-spatial-distributions">3. Spatial distributions<a href="#3-spatial-distributions" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>The notes above describe distributions of attribute values. But, how do we measure spatial distributions? Most often, your objective is to determine if features are <strong>evenly</strong> distributed (<em>uniform distribution</em>) or not, meaning there is a spatial phenomenon taking place. There are <code>3</code> ways of finding if features are <strong>non-randomly</strong> distributed across space:</p>
<h5 id="311-method-1-overlay-grid-and-count">3.1.1 Method 1 - overlay grid and count<a href="#311-method-1-overlay-grid-and-count" class="headerlink" title="Permalink to this heading">¶</a></h5>
<p><img src="../../../images/spatial-overlay-grid.png" width="350"></p>
<p>You can overlay an imaginary grid over your features, count the number of points / features in each cell. Then you compare this metric against a hypothetical even distribution of same features and test for significance.</p>
<h5 id="312-method-2-frequency-distribution-of-distances">3.1.2 Method 2 - frequency distribution of distances<a href="#312-method-2-frequency-distribution-of-distances" class="headerlink" title="Permalink to this heading">¶</a></h5>
<p>You can measure the distances between each feature and its neighbors (after defining a neighborhood threshold) and plot the frequency distribution of the distances.</p>
<h5 id="313-method-3-weighting-attribute-values-by-distance-to-neighbors">3.1.3 Method 3 - weighting attribute values by distance to neighbors<a href="#313-method-3-weighting-attribute-values-by-distance-to-neighbors" class="headerlink" title="Permalink to this heading">¶</a></h5>
<p>To analyze the spatial distribution of attribute values (not features itself, but certain attribute values), you can divide (weigh) the values by distance to neighbors and create a frequency distribution. You can then compare that against a uniform or random distribution.</p>
<h4 id="32-measuring-centrality-of-geographic-distributions">3.2 Measuring centrality of geographic distributions<a href="#32-measuring-centrality-of-geographic-distributions" class="headerlink" title="Permalink to this heading">¶</a></h4>
<p>In traditional statistics, you define centrality using mean, median and mode. Similarly, you can define <strong>mean center</strong>, <strong>median center</strong> and <strong>central feature</strong> in a geographic distribution.</p>
<p><strong>Mean center</strong> is obtained by averaging the X and Y values. <strong>Median center</strong> is calculated by identifying the X and Y coordinate that has the shortest distance to all features. <strong>Central Feature</strong> is the feature that has the shortest distance to all other features. Note, mean and median center may or may not fall on the coordinates of an existing feature, but central feature will.</p>
<h5 id="321-measuring-centrality-weighted-by-some-attribute-value">3.2.1 Measuring centrality weighted by some attribute value<a href="#321-measuring-centrality-weighted-by-some-attribute-value" class="headerlink" title="Permalink to this heading">¶</a></h5>
<p>In practice, you generally want to <strong>weight</strong> the features when measuring the centrality. This becomes particularly important with continuous area features. Since they are continuous, you are not as interested in centrality, but on centrality determined by some attribute value (weight).</p>
<p><img src="../../../images/spatial-weighted-centrality.png" width="500"></p>
<p>Thus, the social service agency looking for a central location to service population over age 65 could calculate it by weighting the distances with the population over age 65.</p>
<p><img src="../../../images/spatial-weighted-centrality2.png" width="500"></p>
<p><strong>Weighted mean center</strong> is calculated as a weighted average: $\bar X = \frac{\sum_{i} (w_{i} X_{i})}{\sum_{i} w_{i}}$ and $\bar Y = \frac{\sum_{i} (w_i Y_{i})}{\sum_{i}w_{i}}$</p>
<p>In case of lines and polygon features, the centers and centroids are used and the mean center is calculated against those point values.</p>
<p><strong>Median center</strong> does not have an exact formula. Instead, the GIS calculates the mean center first, then adjusts it iteratively with slight changes until it finds the median center. It performs <strong>gradient descent</strong> to find the appropriate median center. To find the <strong>weighted median center</strong>, it uses the same technique, except, it multiplies the distances with the <strong>weight</strong> of the corresponding features.</p>
<p><strong>Central feature</strong> is calculated by iterating over each feature, calculating the distance to each other feature and summing it up. The feature with <strong>least total sum</strong> is the central feature. Weighted central feature is calculated similarly, by multiplying the distance with weight.</p>
<p>Reiterating the fact that weighted centers are better for area features, see the case below: When polygons are of varying sizes, the central measure is automatically pulled toward the direction with multiple smaller polygons. This is because, polygons are converted to centroids when calculating distances. To offset this, calculated weighted center</p>
<p><img src="../../../images/spatial-weighted-centrality3.png" width="500"></p>
<h4 id="33-measuring-compactness-of-geographic-distributions">3.3 Measuring compactness of geographic distributions<a href="#33-measuring-compactness-of-geographic-distributions" class="headerlink" title="Permalink to this heading">¶</a></h4>
<p>For non-spatial datasets, the dispersion around the center is measured by <strong>variance</strong> and <a href="../../stats/02_data_description/"><strong>standard deviation</strong></a>. These values gives you the ability to compare compactness of distributions. Similarly, for spatial datasets, the <strong>standard distance</strong>, which is the average distance by which features vary from <strong>mean center</strong> gives a measure of compactness. It is also called the <strong>standard deviation distance</strong>.</p>
<p><img src="../../../images/spatial-std-distance.png" width="350"></p>
<p>When calculating the standard distance, you could calculate it just by distance to features or by multiplying the distance with a weight. When calculating the compactness of polygons, we use weighted distance of their centroids.</p>
<p><img src="../../../images/spatial-std-distance-polygons.png" width="500"></p>
<p>The formula to calculate standard distance with just distances of features to mean center is below:</p>
<p><img src="../../../images/spatial-std-distance-formula1.png" width="350"></p>
<p>Note that it looks very similar to calculating SD, except it sums the variance along <code>X</code> and <code>Y</code> and then takes the square root of their sum.</p>
<p>When weights come into picture, you do a weighted average of the deviation along X and Y as shown below:</p>
<p><img src="../../../images/spatial-std-distance-formula2.png" width="500"></p>
<p>Weights are typically some numerical attribute (such as population if features are polygons, number of entities if features are lines or points). Further, the compactness measure works well if there <strong>no directionality</strong> in the dataset.</p>
    </div>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2022         <a href="mailto:atma.mani@outlook.com">Atma Mani</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>