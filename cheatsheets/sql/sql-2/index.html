<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SQL Queries | Atma's blog</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#d4567b">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://atmamani.github.io/cheatsheets/sql/sql-2/">
<link rel="icon" href="../../../scatter-16.png" sizes="16x16">
<link rel="icon" href="../../../scatter-32.png" sizes="32x32">
<link rel="icon" href="../../../scatter-64.png" sizes="64x64">
<link rel="icon" href="../../../scatter-128.png" sizes="128x128">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-113202945-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-113202945-1');
</script><meta name="author" content="Atma Mani">
<meta property="og:site_name" content="Atma's blog">
<meta property="og:title" content="SQL Queries">
<meta property="og:url" content="https://atmamani.github.io/cheatsheets/sql/sql-2/">
<meta property="og:description" content='Optimizing queries using Index
You can build an index using the CREATE command. Syntax: CREATE INDEX &lt;index name&gt; ON &lt;table&gt; (&lt;col_name&gt;);
sqlite&gt; CREATE INDEX "title_index" ON "shows" ("title");
Run '>
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-12-14T11:22:50-08:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://atmamani.github.io/">

                <span id="blog-title">Atma’s blog</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Projects <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../../../projects/math/">Learn math with Python</a>
                    </li>
<li>
<a href="../../../projects/stats/">Learn stats with Python</a>
                    </li>
<li>
<a href="../../../projects/ml/">Machine Learning projects</a>
                    </li>
<li>
<a href="../../../projects/dl/">Deep Learning projects</a>
                    </li>
<li>
<a href="../../../projects/spatial/">Spatial analysis</a>
                    </li>
<li>
<a href="../../../projects/thermal/">Thermal remote sensing</a>
                    </li>
<li>
<a href="../../../projects/mwrs/">Microwave remote sensing</a>
                    </li>
<li>
<a href="../../../projects/cloud/">Cloud computing</a>
                    </li>
<li>
<a href="../../../projects/fun/">Fun projects</a>
            </li>
</ul>
</li>
<li>
<a href="../../../blog/">Blog</a>
                </li>
<li>
<a href="../../../talks/">Talks</a>
                </li>
<li>
<a href="../../../books/">Books</a>
            </li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Cheatsheets <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../../learning-resources/">General learning resources</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../python/python_datatypes/">Python datatypes</a>
                    </li>
<li>
<a href="../../python/python_numeric_datatypes/">Python numeric datatypes</a>
                    </li>
<li>
<a href="../../python/python_conditional_execution/">Python conditional execution</a>
                    </li>
<li>
<a href="../../python/python_functions/">Python functions</a>
                    </li>
<li>
<a href="../../python/python_iterations/">Python iterations</a>
                    </li>
<li>
<a href="../../python/python_exception_handling/">Python exception handling</a>
                    </li>
<li>
<a href="../../python/python_classes/">Python classes</a>
                    </li>
<li>
<a href="../../python/python_memory/">Python memory, ref counts, garbage collection</a>
                    </li>
<li>
<a href="../../python/python_mutability/">Python - mutability and immutability</a>
                    </li>
<li>
<a href="../../python/python_language_optimizations/">Python - language optimizations</a>
                    </li>
<li>
<a href="../../../images/regex-mindmap.jpg">Python regex</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../golang/">Go introduction</a>
                    </li>
<li>
<a href="../../golang/golang-basics/">Go basics</a>
                    </li>
<li>
<a href="../../golang/golang-datatypes/">Go data types</a>
                    </li>
<li>
<a href="../../golang/golang-control-flow/">Go control flow</a>
                    </li>
<li>
<a href="../../golang/goroutine/">Goroutines - concurrency in Go lang</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../conda_cheat_sheet/">Conda basics</a>
                    </li>
<li>
<a href="../../mamba_cheat_sheet/">Mamba basics</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../numpy/numpy_cheat_sheet_1/">NumPy basics</a>
                    </li>
<li>
<a href="../../numpy/numpy_cheat_sheet_2/">NumPy array slicing, dicing, searching</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../pandas/pandas_cheat_sheet_1/">Pandas basics</a>
                    </li>
<li>
<a href="../../pandas/pandas_cheat_sheet_2/">Pandas multilevel index, <br>    missing data, aggregation, merging</a>
                    </li>
<li>
<a href="../../pandas/pandas_cheat_sheet_3/">Productivity with Pandas</a>
                    </li>
<li>
<a href="../../pandas/pandas_data_viz_1/">Pandas data visualization</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../matplotlib/matplotlib_1/">Matplotlib basics</a>
                    </li>
<li>
<a href="../../matplotlib/matplotlib_2/">Matplotlib log scales, ticks, scientific</a>
                    </li>
<li>
<a href="../../matplotlib/matplotlib_geo/">Geographical plotting with Basemap - matplotlib toolkit</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../seaborn/seaborn_cheat_sheet_1/">Seaborn dist, joint, pair, rug plots</a>
                    </li>
<li>
<a href="../../seaborn/seaborn_cheat_sheet_2/">Seaborn categorical - bar, count, <br>violin, strip, swarm plots</a>
                    </li>
<li>
<a href="../../seaborn/seaborn_cheat_sheet_3/">Seaborn matrix, regression - heatmap, <br> cluster, regression</a>
                    </li>
<li>
<a href="../../seaborn/seaborn_cheat_sheet_4/">Seaborn grids <span class="amp">&amp;</span> custom - pair, facet grids <br> customization</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../plotly/plotly_cufflinks_cheat_sheet_1/">Plotly introduction</a>
                    </li>
<li>
<a href="../../plotly/plotly_cufflinks_cheat_sheet_2/">Plotly - interactive plotting</a>
                    </li>
<li>
<a href="../../plotly/plotly_geographical_plotting_1/">Plotly - geographic plotting</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../r_cheat_sheet_1/">R basics</a>
                    </li>
<li>
<a href="../../octave-1/">Octave / <span class="caps">MATLAB</span> - basics</a>
                    </li>
<li>
<a href="../../octave-2/">Octave - handling data</a>
                    </li>
<li>
<a href="../../js_essentials/">Javascript essentials</a>
                    </li>
<li>
<a href="../../latex-1/">Latex introduction</a>
                    </li>
<li>
<a href="../../docker-1/">Docker introduction</a>
                    </li>
<li>
<a href="../../grep-1/">Grep introduction</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../sql-1"><span class="caps">SQL</span> introduction</a>
                    </li>
<li>
<a href="../sql-2"><span class="caps">SQL</span> Queries</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../open-geo/geopandas-1/">GeoPandas - <span class="caps">IO</span>, projections, plotting</a>
                    </li>
<li>
<a href="../../open-geo/geopandas-2/">GeoPandas - <span class="caps">GP</span>, <span class="caps">IO</span>, interactive plotting, geocoding</a>
                    </li>
<li>
<a href="../../open-geo/geopandas-3/">GeoPandas - spatial overlays, topology</a>
                    </li>
<li>
<a href="../../open-geo/geopandas-4/">GeoPandas - PySal, <span class="caps">OSM</span> data <span class="caps">IO</span></a>
                    </li>
<li>
<a href="../../open-geo/open-geo-raster-1/">Rasterio - <span class="caps">IO</span>, plotting, histograms</a>
                    </li>
<li>
<a href="../../open-geo/open-geo-raster-2/">Rasterio - hyperspectral, <span class="caps">SAM</span></a>
                    </li>
<li>
<a href="../../open-geo/reading-multidim-data-using-opengeotools/">Reading multi-dimensional data using open geo tools</a>
                    </li>
<li>
<a href="../../open-geo/postgis-1/">PostGIS - introduction</a>
                    </li>
<li>
<a href="../../open-geo/postgis-2/">PostGIS - SQLAlchemy, GeoAlchemy, GeoPandas</a>
                    </li>
<li>
<a href="../../open-geo/gdal-1/"><span class="caps">GDAL</span> - an introduction</a>
                    </li>
<li>
<a href="../../open-geo/gdal-2/"><span class="caps">GDAL</span> - quickstart</a>
                    </li>
<li>
<a href="../../../"><hr></a>
                    </li>
<li>
<a href="../../web-development/">Web Development</a>
                    </li>
<li>
<a href="../../html/"><span class="caps">HTML</span> basics</a>
                    </li>
<li>
<a href="../../yaml_syntax/"><span class="caps">YAML</span> Syntax basics</a>
            </li>
</ul>
</li>
<li>
<a href="../../../apps/">Apps</a>
                </li>
<li>
<a href="../../../rss.xml"><span class="caps">RSS</span> feed</a>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="https://atmamani.github.io/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url"><span class="caps">SQL</span> Queries</a></h1>

        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <h3 id="optimizing-queries-using-index">Optimizing queries using Index<a href="#optimizing-queries-using-index" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>You can build an index using the <code>CREATE</code> command. Syntax: <code>CREATE INDEX &lt;index name&gt; ON &lt;table&gt; (&lt;col_name&gt;);</code></p>
<div class="code"><pre class="code literal-block"><span class="n">sqlite</span><span class="o">&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">"title_index"</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">"shows"</span><span class="w"> </span><span class="p">(</span><span class="ss">"title"</span><span class="p">);</span><span class="w"></span>
<span class="n">Run</span><span class="w"> </span><span class="k">Time</span><span class="p">:</span><span class="w"> </span><span class="nb">real</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">151</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">113454</span><span class="w"> </span><span class="n">sys</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">021356</span><span class="w"></span>
</pre></div>

<p>The database uses a <strong>tree</strong> type data structure to optimize the search. Often a <strong>B-tree</strong> data structure is used. The tree is wide horizontally and shallow in tallness. The index creation is expensive, but queries are faster.</p>
<blockquote>
<p>Schema of the <span class="caps">IMDB</span> training table:</p>
</blockquote>
<div class="code"><pre class="code literal-block">sqlite&gt; .schema
CREATE TABLE shows (
                    id INTEGER,
                    title TEXT NOT NULL,
                    year NUMERIC,
                    episodes INTEGER,
                    PRIMARY KEY(id)
                );
CREATE TABLE genres (
                    show_id INTEGER NOT NULL,
                    genre TEXT NOT NULL,
                    FOREIGN KEY(show_id) REFERENCES shows(id)
                );
CREATE TABLE stars (
                show_id INTEGER NOT NULL,
                person_id INTEGER NOT NULL,
                FOREIGN KEY(show_id) REFERENCES shows(id),
                FOREIGN KEY(person_id) REFERENCES people(id)
            );
CREATE TABLE writers (
                show_id INTEGER NOT NULL,
                person_id INTEGER NOT NULL,
                FOREIGN KEY(show_id) REFERENCES shows(id),
                FOREIGN KEY(person_id) REFERENCES people(id)
            );
CREATE TABLE ratings (
                show_id INTEGER NOT NULL,
                rating REAL NOT NULL,
                votes INTEGER NOT NULL,
                FOREIGN KEY(show_id) REFERENCES shows(id)
            );
CREATE TABLE people (
                id INTEGER,
                name TEXT NOT NULL,
                birth NUMERIC,
                PRIMARY KEY(id)
            );
</pre></div>

<h3 id="raw-joins">Raw joins<a href="#raw-joins" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>You can join two tables without actually using a join. This is a primitive and simpler way and is less readable. Below we try to find shows with “Arnold Sch..”.</p>
<div class="code"><pre class="code literal-block"><span class="c1">--Step 1: find person ID of Arnold Sch..</span>
<span class="n">sqlite</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">people</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">"%Arnold Sch%"</span><span class="p">;</span><span class="w"></span>
<span class="mi">216</span><span class="w"></span>

<span class="c1">--Step 2: pass this to stars table to find show id</span>
<span class="n">sqlite</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">show_id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">stars</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">person_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">people</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">"%Arnold Sch%"</span><span class="p">);</span><span class="w"></span>
<span class="mi">200355</span><span class="w"></span>
<span class="mi">1025006</span><span class="w"></span>
<span class="mi">10408914</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>

<span class="c1">--Step 3: pass this to shows table to get show names</span>
<span class="n">sqlite</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">shows</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">show_id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">stars</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">person_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">people</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">"%Arnold Sch%"</span><span class="p">));</span><span class="w"></span>
<span class="mi">200355</span><span class="o">|</span><span class="n">Moviewatch</span><span class="o">|</span><span class="mi">1993</span><span class="o">|</span><span class="mi">68</span><span class="w"></span>
<span class="mi">1025006</span><span class="o">|</span><span class="n">Regis</span><span class="w"> </span><span class="n">Philbin</span><span class="s1">'s Lifestyles|1984|11</span>
<span class="s1">1388415|Citizen Kate|2008|</span>
<span class="s1">1990507|Climate One Commonwealth Club Forum|2010|2</span>
<span class="s1">2963070|Years of Living Dangerously|2014|17</span>
<span class="s1">4074786|Radical Body Transformations|2015|30</span>
<span class="s1">4995052|Explorer|2015|42</span>
<span class="s1">5290904|Talking to Hollywood with Betty Zhou|2015|5</span>
<span class="s1">7423218|Objectified|2016|25</span>
<span class="s1">10408914|Superhero Kindergarten|2021|14</span>
<span class="s1">10922386|Chad Goes Deep|2017|32</span>
<span class="s1">12591074|Hallo, wie geht'</span><span class="n">s</span><span class="o">|</span><span class="mi">1989</span><span class="o">|</span><span class="mi">37</span><span class="w"></span>
<span class="mi">14650368</span><span class="o">|</span><span class="n">The</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">Celebrity</span><span class="w"> </span><span class="n">Apprentice</span><span class="o">|</span><span class="mi">2017</span><span class="o">|</span><span class="mi">7</span><span class="w"></span>
<span class="mi">15545956</span><span class="o">|</span><span class="n">Action</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Neu</span><span class="w"> </span><span class="n">im</span><span class="w"> </span><span class="n">Kino</span><span class="o">|</span><span class="mi">1986</span><span class="o">|</span><span class="w"></span>
</pre></div>

<p>I had no idea Arnold Schwarzenegger acted in so many shows, some as recent at 2021!</p>
<h3 id="simple-joins">Simple JOINs<a href="#simple-joins" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>You can <span class="caps">JOIN</span> two tables using the syntax: Here <code>PK - primary key</code> and <code>FK - foreign key</code>.</p>
<div class="code"><pre class="code literal-block"><span class="c1">-- Simple join syntax</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">&lt;</span><span class="n">cols</span><span class="o">&gt;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tableA</span><span class="o">&gt;</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tableB</span><span class="o">&gt;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="o">&lt;</span><span class="n">how_to_join</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">fullname</span><span class="p">,</span><span class="w"> </span><span class="n">cars</span><span class="p">.</span><span class="n">mileage_info</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">cars</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">car_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cars</span><span class="p">.</span><span class="n">name</span><span class="w"></span>

<span class="c1">-- With where and order by</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">&lt;</span><span class="n">cols_to_disp</span><span class="o">&gt;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tableA</span><span class="o">&gt;</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tableB</span><span class="o">&gt;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tableA</span><span class="p">.</span><span class="n">PK</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tableB</span><span class="p">.</span><span class="n">FK</span><span class="o">&gt;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="o">&lt;</span><span class="n">condition</span><span class="o">&gt;</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="o">&lt;</span><span class="n">field</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
</pre></div>

<p>You can nest multiple joins as shown below:</p>
<div class="code"><pre class="code literal-block"><span class="n">sqlite</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">people</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">stars</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">people</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stars</span><span class="p">.</span><span class="n">person_id</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">shows</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">stars</span><span class="p">.</span><span class="n">show_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">people</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">"Arnold Sch%"</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="k">year</span><span class="p">;</span><span class="w"></span>
</pre></div>

<p>Another style to write this join, if you know the tables being used before hand, is this:</p>
<div class="code"><pre class="code literal-block"><span class="k">SELECT</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">people</span><span class="p">,</span><span class="w"> </span><span class="n">stars</span><span class="p">,</span><span class="w"> </span><span class="n">shows</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">people</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stars</span><span class="p">.</span><span class="n">person_id</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">stars</span><span class="p">.</span><span class="n">show_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">people</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">"Arnold Sch%"</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="k">year</span><span class="p">;</span><span class="w"></span>
</pre></div>

<p>Notice the command <code>JOIN</code> does not show up in the case above.</p>
<h3 id="problem-sets">Problem sets:<a href="#problem-sets" class="headerlink" title="Permalink to this heading">¶</a></h3>
<ol>
<li>
<strong>How many shows to type ‘Comedy’ were directed during a leap year?</strong>: This is a simple join between <code>shows</code> and <code>genres</code> tables. Use <code>%</code> operator as a modulus.</li>
</ol>
<div class="code"><pre class="code literal-block"><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">shows</span><span class="w"></span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">genres</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">genres</span><span class="p">.</span><span class="n">show_id</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="k">year</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="k">AND</span><span class="w"> </span><span class="n">genres</span><span class="p">.</span><span class="n">genre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">"Comedy"</span><span class="p">;</span><span class="w"></span>
</pre></div>

<ol>
<li>
<strong>List all actors that have acted in a show called “Anandham”.</strong>: This requires joining 3 tables - <code>person</code>, <code>stars</code>, <code>shows</code> and getting the actor names</li>
</ol>
<div class="code"><pre class="code literal-block"><span class="k">SELECT</span><span class="w"> </span><span class="n">people</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">people</span><span class="w"></span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">stars</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">people</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stars</span><span class="p">.</span><span class="n">person_id</span><span class="w"> </span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">shows</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">stars</span><span class="p">.</span><span class="n">show_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="n">id</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">"Anandham"</span><span class="p">;</span><span class="w"></span>
</pre></div>

<p>which returns:</p>
<div class="code"><pre class="code literal-block"><span class="gh">name             </span>
<span class="gh">-----------------</span>
Saakshi Sivaa    
Brinda Das       
Kamalesh         
<span class="gh">Delhi Kumar</span>
<span class="gh">...</span>
</pre></div>

<ol>
<li>
<strong>Find the number of actors that acted in shows between 1970 and 1990</strong>: This requires joining the same 3 tables and counting distinct actor ids:</li>
</ol>
<div class="code"><pre class="code literal-block"><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">people</span><span class="p">.</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">PEOPLE</span><span class="w"> </span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">stars</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">people</span><span class="p">.</span><span class="n">id</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stars</span><span class="p">.</span><span class="n">person_id</span><span class="w"> </span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">shows</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">stars</span><span class="p">.</span><span class="n">show_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="n">id</span><span class="w"> </span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="k">year</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">1970</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">1990</span><span class="p">;</span><span class="w"></span>
</pre></div>

<p>returns</p>
<div class="code"><pre class="code literal-block"><span class="gh">COUNT(DISTINCT people.id)</span>
<span class="gh">-------------------------</span>
72095
</pre></div>

<ol>
<li>
<strong>How many actors also worked as writers</strong>?</li>
</ol>
<div class="code"><pre class="code literal-block"><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">people</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span>
<span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">stars</span><span class="p">.</span><span class="n">person_id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">stars</span><span class="w"> </span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">writers</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">stars</span><span class="p">.</span><span class="n">person_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">writers</span><span class="p">.</span><span class="n">person_id</span><span class="p">);</span><span class="w"></span>
</pre></div>

<ol>
<li><strong>List to top 10 shows that have highest votes and highest rating</strong></li>
</ol>
<div class="code"><pre class="code literal-block"><span class="k">SELECT</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="n">episodes</span><span class="p">,</span><span class="w"> </span><span class="n">ratings</span><span class="p">.</span><span class="n">rating</span><span class="p">,</span><span class="w"> </span><span class="n">ratings</span><span class="p">.</span><span class="n">votes</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">shows</span><span class="w"> </span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">ratings</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">shows</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ratings</span><span class="p">.</span><span class="n">show_id</span><span class="w"> </span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ratings</span><span class="p">.</span><span class="n">votes</span><span class="w"> </span><span class="k">DESC</span><span class="p">,</span><span class="w"> </span><span class="n">ratings</span><span class="p">.</span><span class="n">rating</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
</pre></div>

<p>returns</p>
<div class="code"><pre class="code literal-block">title                  year  episodes  rating  votes  
---------------------  ----  --------  ------  -------
Game of Thrones        2011  73        9.2     1888391
Breaking Bad           2008  62        9.4     1596038
Stranger Things        2016  34        8.7     920887 
The Walking Dead       2010  177       8.2     907667 
Friends                1994  235       8.8     905205 
Sherlock               2010  15        9.1     854590 
The Big Bang Theory    2007  280       8.1     754516 
Dexter                 2006  96        8.6     679125 
How I Met Your Mother  2005  208       8.3     635758 
True Detective         2014  24        8.9     524834
</pre></div>
    </div>
    

</article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         <a href="mailto:atma.mani@outlook.com">Atma Mani</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>